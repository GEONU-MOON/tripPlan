<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tripPlan</title>

    <link rel="stylesheet" href="../css/travel_itinerary_management.css" />
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="icon" href="../img/favicon.png" type="image/x-icon" />
  </head>
  <body>
    <div class="wrap">
      <div class="top"><img src="../img/logo.svg" alt="Logo" /> 뉴욕 여행</div>

      <div class="tab">
        <ul class="on">
          2024-10-24
        </ul>
        <ul>
          2024-10-25
        </ul>
      </div>

      <!-- 오른쪽 하단 고정 버튼 -->
      <div class="floating-btn" id="openPopupBtn">+</div>

      <!-- 팝업 오버레이 -->
      <div class="popup-overlay" id="popup">
        <div class="popup-content">
          <h3>항목 추가</h3>
          <label for="item-type">항목 유형 선택:</label>
          <select id="item-type">
            <option value="">선택</option>
            <option value="move">이동</option>
            <option value="default">일반</option>
          </select>

          <!-- 이동 항목 폼 -->
          <div id="move-form" class="item-form" style="display: none">
            <label for="transport-type">이동 수단 선택:</label>
            <select id="transport-type">
              <option value="plane_start">비행기 이륙</option>
              <option value="plane_end">비행기 착륙</option>
              <option value="bus">버스</option>
              <option value="subway">열차</option>
              <option value="taxi">택시</option>
              <option value="walk">걷기</option>
              <option value="boat">보트</option>
            </select>
            <label>시간: <input type="time" id="move-time" /></label>
            <label
              >출발지:
              <input type="text" id="move-title" placeholder="출발지 입력"
            /></label>
            <label
              >설명:
              <input type="text" id="move-description" placeholder="설명 입력"
            /></label>
            <label
              >가격:
              <input type="number" id="move-price" placeholder="가격 입력"
            /></label>
            <button onclick="addMoveItem()">이동 항목 추가</button>
          </div>

          <!-- 일반 항목 폼 -->
          <div id="default-form" class="item-form" style="display: none">
            <label>시간: <input type="time" id="default-time" /></label>
            <label
              >제목:
              <input type="text" id="default-title" placeholder="제목 입력"
            /></label>
            <label
              >설명:
              <input
                type="text"
                id="default-description"
                placeholder="설명 입력"
            /></label>
            <label
              >수량:
              <input type="number" id="default-qty" placeholder="수량 입력"
            /></label>
            <label
              >이미지 URL:
              <input type="text" id="default-img" placeholder="이미지 URL 입력"
            /></label>
            <label
              >해시태그:
              <input
                type="text"
                id="default-tags"
                placeholder="태그 입력 (쉼표로 구분)"
            /></label>
            <button onclick="addDefaultItem()">일반 항목 추가</button>
          </div>
          <button onclick="closePopup()">닫기</button>
        </div>
      </div>

      <div class="list" id="item-list">
        <!-- 항목들이 추가될 리스트 -->
      </div>
      <p id="noItemsMessage" class="no-items-message">일정을 등록하세요</p>
    </div>

    <script>
      // 팝업 열기
      document
        .getElementById("openPopupBtn")
        .addEventListener("click", function () {
          popup.style.display = "flex";
        });

      // 팝업 닫기
      function closePopup() {
        popup.style.display = "none";
      }

      // 항목 유형 선택 시 폼 표시
      document
        .getElementById("item-type")
        .addEventListener("change", function () {
          const itemType = this.value;
          document.getElementById("move-form").style.display =
            itemType === "move" ? "block" : "none";
          document.getElementById("default-form").style.display =
            itemType === "default" ? "block" : "none";
        });

      // 안내 메시지 토글 함수
      function toggleNoItemsMessage() {
        const itemList = document.getElementById("item-list");
        const noItemsMessage = document.getElementById("noItemsMessage");
        noItemsMessage.style.display =
          itemList.children.length === 0 ? "block" : "none";
      }

      // 이동 항목 추가 함수
      function addMoveItem() {
        const transportType = document.getElementById("transport-type").value;
        const time = document.getElementById("move-time").value;
        const title = document.getElementById("move-title").value;
        const description = document.getElementById("move-description").value;
        const price = document.getElementById("move-price").value;

        const itemList = document.getElementById("item-list");
        const newItem = document.createElement("ul");
        newItem.className = "move";
        newItem.innerHTML = `
    <div class="ico"><img src="../img/${transportType}.svg" /></div>
    <div class="price">$${price}</div>
    <div class="info">
      <li class="date">${time}</li>
      <li class="title">${title}</li>
      <li class="txt">${description}</li>
    </div>
  `;
        itemList.appendChild(newItem);

        toggleNoItemsMessage(); // 안내 메시지 토글
        document.getElementById("move-form").reset(); // 폼 초기화
        closePopup(); // 팝업 닫기
      }

      // 일반 항목 추가 함수
      function addDefaultItem() {
        const time = document.getElementById("default-time").value;
        const title = document.getElementById("default-title").value;
        const description = document.getElementById(
          "default-description"
        ).value;
        const qty = document.getElementById("default-qty").value;
        const imgURL = document.getElementById("default-img").value;
        const tags = document
          .getElementById("default-tags")
          .value.split(",")
          .map((tag) => tag.trim());

        const itemList = document.getElementById("item-list");
        const newItem = document.createElement("ul");
        newItem.className = "default";
        newItem.innerHTML = `
    <div class="info">
      <li class="date">${time}</li>
      <li class="title">${title}</li>
      <li class="txt">${description}</li>
    </div>
    <div class="thumb">
      <div class="qty">${qty}</div>
      <div class="box">
        <img src="${imgURL}" alt="Thumbnail" />
      </div>
    </div>
    <div class="link">
      ${tags.map((tag) => `<span class="tag">#${tag}</span>`).join("")}
    </div>
  `;
        itemList.appendChild(newItem);

        toggleNoItemsMessage(); // 안내 메시지 토글
        document.getElementById("default-form").reset(); // 폼 초기화
        closePopup(); // 팝업 닫기
      }
    </script>
  </body>
</html>
